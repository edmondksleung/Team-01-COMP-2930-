<!DOCTYPE html>
<html lang="en">

<head>
    <title>Sign in to eVolunteer</title>
    <link rel="stylesheet" type="text/css" href="css/signIn.css">

    <!--JQuery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.4/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />
    <script>
        //skip login page while signed in.
        $(document).ready(function () {
            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    setTimeout(function () {
                        $('.subPageWrapper').fadeIn(500);
                    }, 1000);
                    $('.subPageWrapper').css('display: block');
                } else {
                    $(".wrapper").show();
                }
            });
        });
    </script>
    <!-- Initialize Firebase -->
    <script>
        var config = {
            apiKey: "AIzaSyCjKV-p_CGqxhRcxahylr-6LXUzNax6kek",
            authDomain: "evolunteer-45c5d.firebaseapp.com",
            databaseURL: "https://evolunteer-45c5d.firebaseio.com",
            projectId: "evolunteer-45c5d",
            storageBucket: "evolunteer-45c5d.appspot.com",
            messagingSenderId: "412878968573"
        };
        firebase.initializeApp(config);
        var rootRef = firebase.database().ref();
    </script>

</head>

<body>
        <div id="e">test</div>
    <div class="wrapper">
        <div class="container">
            <div id="logo">
                <img src="https://media1.giphy.com/media/l1KVcrdl7rJpFnY2s/giphy.gif" alt="logoPic">
            </div>
            <h1 id="title">
                <b>
                    <span>e</span>Volunteer</b>
            </h1>
            <form class="form">
                <input type="text" placeholder="Username" id="emailField">
                <input type="password" placeholder="Password" id="passField">
                <button type="submit" id="loginButton">Login</button>

                <div id="signUpMargin">
                    <a id="signUp">No Account? Sign Up</a>
                    <div id="myModal" class="modal">
                        <!-- Modal content -->
                        <div id="firebaseui-auth-container">
                        </div>
                    </div>
                </div>

            </form>
        </div>
        <ul class="bg-bubbles">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div>
    <!------------------------NAV PAGE----------------------------------->
    <div class="subPageWrapper">
        <div id="topBox">
            <div id="evolunteer">Welcome!</div>
            <div>
                <button onclick="logout()" type="submit" id="logoutButton">Log Out</button>
            </div>
            </div>
        </div>
        <div id="mainBox"><img id="globeLogo" src="https://media1.giphy.com/media/l1KVcrdl7rJpFnY2s/giphy.gif" alt="">
        </div>
            <!--MAIN SUB WRAPPER-->
    <div class="mainPageWrapper">
        <div id="userStatus"></div>

        <div class="cityImage"
            style="background-image: url(https://upload.wikimedia.org/wikipedia/commons/a/a0/FuturebigToronto.jpg);">
            <h1>VANCOUVER</h1>
        </div>

        <div class="cityImage"
            style="background-image: url(https://res.cloudinary.com/g5-assets-cld/image/upload/x_0,y_326,h_3389,w_5648,c_crop/q_auto,f_auto,fl_lossy,g_center,h_1200,w_2000/g5/g5-c-5cpnmi9wp-quadreal/g5-cl-1hj4q9obd6-parkview-towers/uploads/0Z8A6304_d5hshm.jpg);">
            <h1>BURNABY</h1>
        </div>

        <div class="cityImage"
            style="background-image: url(http://greatplacesincanada.ca/wp-content/uploads/2017/10/Town_Centre_Park.jpg);">
            <h1>COQUITLAM</h1>
        </div>




    </div>


    <script>
        // firebase.auth().onAuthStateChanged(function (user) {
        //     if (user) {
        // User is signed in.

        // document.getElementsByClassName("wrapper").style.display = "none";
        // document.getElementsByClassName("mainPageWrapper").style.display = "block";

        // var user = firebase.auth().currentUser;

        //         if (user != null) {

        //             var email_id = user.email;
        //             document.getElementById("userStatus").innerHTML = "Welcome User : " + email_id;

        //         }

        //     } else {
        //         // No user is signed in.

        //         document.getElementsByClassName("wrapper").style.display = "block";
        //         document.getElementsByClassName("mainPageWrapper").style.display = "none";

        //     }
        // });

        // function login() {

        //     var userEmail = document.getElementById("email_field").value;
        //     var userPass = document.getElementById("password_field").value;

        //     firebase.auth().signInWithEmailAndPassword(userEmail, userPass).catch(function (error) {
        //         // Handle Errors here.
        //         var errorCode = error.code;
        //         var errorMessage = error.message;

        //         window.alert("Error : " + errorMessage);

        //         // ...
        //     });

        // }
        // firebase.auth().onAuthStateChanged(user => {
        //     if (user) {
        //         window.location = 'index.html'; //After successful login, user will be redirected to index.html
        //     }
        // });
    </script>
    <script>
        // var user = firebase.auth().currentUser;

        //Function event jquery function upon clicking login button
        $('#loginButton').click(function (event) {
            event.preventDefault();


            //If firebase user recognized...
            //Fades out the login form,
            //Shifts the eVolunteer h1 header downwards,
            //Fades out the signIn page
            var user = firebase.auth().currentUser;
            var userEmail = $("#emailField").val();
            var userPass = $("#passField").val();

            firebase.auth().signInWithEmailAndPassword(userEmail, userPass).catch(function (error) {

                $('#loginButton').addClass('invalid');
                setTimeout(function () {
                    $('#loginButton').removeClass('invalid');
                }, 1000);
            });

            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    $('form').fadeOut(50);
                    $('.wrapper').addClass('form-success');
                    $('.form-success').fadeOut(2000);
                    setTimeout(function () {
                        $('.subPageWrapper').fadeIn(4000);
                    }, 1000);
                    $('.subPageWrapper').css('display: block');
                }

            });
        });
    </script>


    <script>
        //---------------------SIGN OUT------------------------
        function logout() {
            firebase.auth().signOut();
            alert('Logged Out');
            window.location = 'signIn.html';
        }
    </script>


    <script>
        $("#globeLogo").click(function () {
            $(".subPageWrapper").fadeOut(500);
            setTimeout(function () {
                $('.mainPageWrapper').fadeIn(2000);
            }, 1000);
            $('.mainPageWrapper').display('block');
        });
    </script>

    <script>
        $('#signUp').click(function (event) {

            // Initialize the FirebaseUI widget using Firebase.
            var ui = new firebaseui.auth.AuthUI(firebase.auth());

            var uiConfig = {
                callbacks: {
                    signInSuccessWithAuthResult: function (authResult, redirectUrl) {
                        // User successfully signed in.
                        // Return type determines whether we continue the redirect automatically
                        // or whether we leave that to developer to handle.
                        return true;
                    },

                },
                // Will use popup for IDP Providers sign-in flow instead of the default, redirect.
                signInFlow: 'popup',
                signInSuccessUrl: 'signIn.html',
                signInOptions: [
                    // Leave the lines as is for the providers you want to offer your users.
                    firebase.auth.EmailAuthProvider.PROVIDER_ID,
                    firebase.auth.GoogleAuthProvider.PROVIDER_ID,
                    firebase.auth.FacebookAuthProvider.PROVIDER_ID,
                    firebase.auth.GithubAuthProvider.PROVIDER_ID,
                ],
                // Terms of service url.
                tosUrl: 'signIn.html',
                // Privacy policy url.
                privacyPolicyUrl: 'signIn.html'
            };

            // The start method will wait until the DOM is loaded.
            ui.start('#firebaseui-auth-container', uiConfig);
        });
    </script>
    <script>
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var signUpButton = document.getElementById("signUp");

        // When the user clicks on the button, open the modal 
        signUpButton.onclick = function () {
            modal.style.display = "block";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
    <script>
       var helloSound = new Audio('/Users/erickim/Desktop/Comp2930/public/Audio/test.mp3');
helloSound.src = "/Users/erickim/Desktop/Comp2930/public/Audio/test.mp3"; 

// var goodbyeSound = new Audio('goodbye.mp3');
// goodbyeSound.src = "goodbye.mp3";

var homeLink = document.getElementById('e');

homeLink.addEventListener('click', function () {
        helloSound.play();
}); 
    </script>
</body>

</html>